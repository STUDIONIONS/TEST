!function(){let c=0,u=null,m=localStorage.getItem("events")?JSON.parse(localStorage.getItem("events")):{};const y=document.getElementById("calendar"),e=document.getElementById("add"),s=document.getElementById("newEventModal"),g=document.getElementById("deleteEventModal"),v=document.getElementById("modalBackDrop"),p=document.getElementById("titleDate0"),E=document.getElementById("titleDate1"),L=document.getElementById("eventTitleDate"),f=document.getElementById("eventTitleInput"),d=document.getElementById("eventTitleWorker"),t=document.querySelectorAll(".today"),B=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];function S(e,t){var n=u==e;const d=e.split("/"),a=d.join(""),l=(d.join("-"),m["d-"+a]),i=new Date(d[2],d[0]-1,d[1]);u=e;let r=i.toLocaleDateString(navigator.language,{weekday:"long",year:"numeric",month:"long",day:"numeric"}),o=String(d[2]).padStart(4,"0")+"-"+String(d[0]).padStart(2,"0")+"-"+String(d[1]).padStart(2,"0");null!=l&&t&&t.id&&(t=l[e=t.id.split("-")[2]])?(document.getElementById("eventText").innerText=t.title,document.getElementById("eventWorker").innerText=t.body,E.innerText=r,g.setAttribute("data-edit",e),g.setAttribute("data-date",a),g.style.display="block"):(s.style.display="block",p.innerText=r,L.style.display=n?"none":"block",p.style.display=n?"block":"none",setTimeout(function(){f.focus(),L.value=o},0)),v.style.display="flex"}function a(e){const t=new Date,d=(t.setDate(1),t.setMonth(t.getMonth()+c),(new Date).getDate()),a=t.getMonth(),l=t.getFullYear(),n=new Date(l,a,0),i=new Date(l,a+1,0).getDate(),r=n.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"numeric",day:"numeric"}),s=B.indexOf(r.split(", ")[0]);function o(){var t,n;for(let e=1;e<=s+i;e++){let i=document.createElement("div"),t=(i.classList.add("day"),`${a+1}/${e-s}/`+l),r="d-"+t.split("/").join(""),o=String(e-s).padStart(2,"0")+"."+String(a+1).padStart(2,"0")+"."+String(l);e>s?(i.setAttribute("data-curday",e-s),n=Array.isArray(m[r])?m[r]:null,e-s===d&&0===c&&i.classList.add("current_day"),n&&Array.isArray(n)&&(i.classList.add("events"),n.forEach(function(e,t,n){let d=document.createElement("div"),a=document.createElement("div"),l=document.createElement("div");i.appendChild(l),d.classList.add("event"),a.classList.add("event"),d.innerText=e.title,a.innerText=e.body,l.appendChild(d),l.appendChild(a),l.classList.add("event_work"),l.title=`Дата:
	${o}
Ф.И.О:
	${a.innerText}
Описание:
	`+d.innerText,l.id=r+"-"+t})),i.addEventListener("click",e=>(e.preventDefault(),S(u=t,e.target),!1))):i.classList.add("padding"),y.appendChild(i)}if(t=(s+i)%7){t=7-t;for(let e=1;e<=t;++e){let e=document.createElement("div");e.classList.add("day"),e.classList.add("padding"),y.appendChild(e)}}}document.getElementById("monthDisplay").innerText=t.toLocaleDateString(navigator.language,{month:"long"})+" "+l,y.innerHTML="",e?setTimeout(o,10):o()}function l(){f.classList.remove("error"),d.classList.remove("error"),s.style.display="none",g.style.display="none",v.style.display="none",f.value="",d.value="",u=null,g.removeAttribute("data-edit"),g.removeAttribute("data-date")}function n(){var e,t=f.value.trim(),n=d.value.trim();t&&n?(f.classList.remove("error"),d.classList.remove("error"),e="d-"+u.split("/").join(""),Array.isArray(m[e])||(m[e]=[]),m[e].length,m[e].push({date:u,title:t,body:n}),localStorage.setItem("events",JSON.stringify(Object.assign({},m))),a(),l()):(f.classList.add("error"),d.classList.add("error"))}function i(){var e=g.getAttribute("data-edit"),t="d-"+g.getAttribute("data-date");m[t].splice(e,1),m[t].length||delete m[t],localStorage.setItem("events",JSON.stringify(m)),a(),l()}function r(e){if(13==e.keyCode)return e.preventDefault(),n(),!1}document.getElementById("nextButton").addEventListener("click",()=>{++c,a(!0)}),document.getElementById("prevButton").addEventListener("click",()=>{--c,a(!0)}),t.forEach(function(t){t.addEventListener("click",function(e){"update"!=t.id&&(c=0),a(!0)})}),document.getElementById("saveButton").addEventListener("click",n),document.getElementById("cancelButton").addEventListener("click",l),document.getElementById("deleteButton").addEventListener("click",i),document.getElementById("closeButton").addEventListener("click",l),f.addEventListener("keydown",r),d.addEventListener("keydown",r),e.addEventListener("click",e=>{e.preventDefault();let t=new Date,n=t.getDate(),d=t.getMonth(),a=t.getFullYear(),l=d+1+`/${n}/`+a;return u=null,S(l),!1}),a()}();